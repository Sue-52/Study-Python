## Mysql 应掌握知识点

### 查看数据库和表

#### 查看数据库

~~~mysql
SHOW DATABASES;
~~~

![image-20211013180347463](./img/image-20211013180347463.png)

SHOW DATABASES;返回可用数据库的一个列表。包含在这个列表中的可能是MySQL内部使用的数据库（如例子中的mysql和information_schema）。


#### 使用数据库

~~~mysql
use 数据库名;
~~~

进入某个数据库中

![image-20211013191952910](./img/image-20211013191952910.png)

#### 查看表

~~~mysql
show tables;
~~~

返回当前选择的数据库内可用表的列表。

![image-20211013192102334](./img/image-20211013192102334.png)

#### 查看表下的所有列

~~~mysql
show columns from cities;
~~~

SHOW COLUMNS 要求给出一个表名（这个例子中的 FROM customers），它对每个字段返回一行，行中包含字段名、数据类型、是否允许NULL、键信息、默认值以及其他信息（如字段cust_id的auto_increment）。

![image-20211013193101724](./img/image-20211013193101724.png)

#### 其他语法：

~~~mysql
-- 用于显示广泛的服务器状态信息
SHOW STATUS;

-- 分别用来显示创建特定的数据库或表的MYSQL语句
SHOW CREATE DATABASE;
SHOW CREATE TABLE;

-- 用来显示授予用户（所有用户或特定用户）的安全权限
SHOW GRANTS;

-- 用来显示服务器或者警告信息
SHOW ERRORS;
SHOW WARNINGS;
~~~

### 检索语句 SELECT

`SELECT` 语句用于检索表的数据
语法格式：

~~~mysql
select xxx from 表名
~~~

#### 检索单个列表数据

~~~mysql
select 列名 from 表名;
~~~

利用 `SELECT` 语句从 cities 表中检索一个名为：`name` 的列。所需的列名在 `SELECT` 关键字之后给出， FROM 关键在指出从中检索数据的表名。

![image-20211013194638908](./img/image-20211013194638908.png)

#### 检索多个列表数据

~~~mysql
select 列名1，列名2... from 表名;
~~~

通过给定的多个 列名... 进行检索

![image-20211013195213117](./img/image-20211013195213117.png)


#### 检索所有列表数据

~~~mysql
select * from 表名;
~~~

如果给定一个通配符（*），则返回表中所有列。列的顺序一般是列在表定义中出现的顺序。但有时候并不是这样的，表的模式的变化（如添加或删除列）可能会导致顺序的变化。

![image-20211013195736139](./img/image-20211013195736139.png)


#### 检索不同的行数据（去重）

当我们需要查看表中不同的数据，将重复的值去除的话 可以使用 `DISTINCT` 关键字。

~~~mysql
select type from cities;
~~~

![image-20211013200243176](./img/image-20211013200243176.png)

上图我们发现了有许多重复的数据，这是我们不想要看到的

~~~
select distinct type from cities;
~~~

![image-20211013200353438](./img/image-20211013200353438.png)

DISTINCT关键字应用于所有列而不仅是前置它的列。如果给出SELECT DISTINCT type, code，除非指定的两个列都不同，否则所有行都将被
检索出来。


#### 使用完全限定的表名

~~~mysql
select 表名.列名 from 数据库名.表名
~~~

将语法限定在只用**该数据库下的这个表中的列才能获取**

![image-20211013200705559](./img/image-20211013200705559.png)

### 排序检索数据 SELECT ... ORDER BY ...

其实，检索出来的数据并不是以纯粹的随即顺序显示的。如果不排序，数据一般将以它的底层表中出现的顺序显示。这可以是数据最初添加到表中的顺序。但是，如果数据后来进行过更新或删除，则此顺序将会受到 `MySQL` 重用回收存储空间的影响。因此，如果不明确控制的话，不能（也不应该）依赖该排序顺序。关系数据库设计理论认为，如果不明确规定排序顺序，则不应该假定检索出的数据的顺序有意义。

**子句（clause）：** SQL 语句由子句构成，有些子句是必要的，有的是可选的。一个字句通常由一个关键字和所提供的数据组成。

其中 `ORDER BY` 子句，取一个或者多个列的名字，根据列输出对应序列的排序。

#### 排序数据

~~~mysql
select 列名 from 表名 order by 表名
~~~

![image-20211013203837684](./img/image-20211013203837684.png)

#### 多列排序

按不止一个列进行数据排序。

为了按多个列排序，只要指定列名，列名之间用逗号分开即可（就像选择多个列时所做的那样）。

~~~mysql
select 列名1，列名2... from 表名 order by 列名1，列名2...;
~~~

![image-20211013211053126](./img/image-20211013211053126.png)


#### 按照指定顺序排序 DESC、ASC、LIMIT

DESC：使列表降序排列
ASC：使列表升序排列（默认即为升序）
LIMIT：限制显示的数量（必须位于ORDER BY之后）

~~~mysql
-- 语法
select 列名1，列名2... from 表名 order by 列名1，列名2... limit 数量;

-- 检索
select id,name,code from cities order by name desc limit 10;
~~~

![image-20211013211618969](./img/image-20211013211618969.png)


### 过滤数据 WHERE

数据库表一般包含大量的数据，很少需要检索表中所有行。通常只会根据特定操作或报告的需要提取表数据的子集。只检索所需数据需要指定搜索条件（search criteria），搜索条件也称为过滤条件（filter condition）。

> **数据根据WHERE子句中指定的搜索条件进行过滤。WHERE子句在表名（FROM子句）之后给出**

数据也可以在应用层过滤。为此目的，SQL的SELECT语句为了客户机应用检索出超过实际所需数据，然后客户机代码对返回数据进行循环，以提取出需要
的行。

通常，这种实现并不令人满意。因此，对数据库进行了优化，以便快速有效地对数据进行过滤。让客户机应用（或开发语言）处理数据库的工作将会极大地影响应用的性能，并且使所创建的应用完全不具备可伸缩性。此外，如果在客户机上过滤数据，服务器不得不通过网络发送多余的数据，这将导致网络带宽的浪费。

**在同时使用`ORDER BY`和`WHERE`子句时，应该让`ORDER BY`位于`WHERE`之后，否则将会产生错误**

| WHERE 子句操作符 | 描述 |
|-----------------|------|
| = | 等于 |
| <> | 不等于 |
| != | 不等于 |
| < | 小于 |
| <= | 小于等于 |
| > | 大于 |
| >= | 大于等于 |
| BETWEEN ... AND ... | 在指定的两个值之间 |

#### 检查单个值

~~~mysql
SELECT XXX FROM XXX WHERE 列名 操作符 值
~~~

![image-20211014211522217](./img/image-20211014211522217.png)


#### 不匹配检查

~~~mysql
SELECT XXX FROM XXX WHERE 列名 <> 值
~~~

![image-20211014211937641](./img/image-20211014211937641.png)

> 所查到的数据中没有了 id 为 330 的数据

如果仔细观察上述WHERE子句中使用的条件，会看到有的值括在单引号内（如前面使用的'fuses'），而有的值未括起来。单引号用来限定字符串。如果将值与串类型的列进行比较，则需要限定引号。用来与数值列进行比较的值不用引号。

#### 范围检查

查询值在某个范围内部

~~~mysql
SELECT XXX FROM XXX WHERE 列名 BETWEEN 值 AND 值;
~~~

![image-20211014212311865](./img/image-20211014212311865.png)

在使用BETWEEN时，必须指定两个值——所需范围的低端值和高端值。这两个值必须用AND关键字分隔。BETWEEN匹配范围中所有的值，包括指定的开始值和结束值。

#### 空值检测

检查对应的值是否为空

> NULL 无值（no value），它与字段包含0、空字符串或仅仅包含空格不同。

~~~mysql
SELECT XXX FROM XXX WHERE 列名 IS NULL;
~~~

![image-20211014212938364](./img/image-20211014212938364.png)

在通过过滤选择出不具有特定值的行时，你可能希望返回具有NULL值的行。但是，不行。因为未知具有特殊的含义，数据库不知道它们是否匹配，所以在匹配过滤或不匹配过滤时不返回它们。 

因此，在过滤数据时，一定要验证返回数据中确实给出了被过滤列具有NULL的行。


### 数据过滤

之前所有WHERE子句在过滤数据时使用的都是单一的条件。为了进行更强的过滤控制，MySQL允许给出多个WHERE子句。这些子句可以两种方式使用：以AND子句的方式或OR子句的方式使用。

**操作符（operator）** 用来联结或改变WHERE子句中的子句的关键字。也称为**逻辑操作符（logical operator）**。

#### AND 操作符

使用 `AND` 操作符，查询出来的数据必须符合两个判断条件的要求才会显示。

还可以添加多个过滤条件，每添加一条就要使用一个AND。

~~~mysql
SELECT XXX FROM XXX WHERE 列名1 操作符 值1 AND 列名2 操作符 值2;
~~~

![image-20211015090942739](./img/image-20211015090942739.png)

#### OR 操作符

检索匹配任一条件的行。

~~~mysql
SELECT XXX FROM XXX WHERE 列名1 操作符 值1 OR 列名2 操作符 值2;
~~~

![image-20211015091413096](./img/image-20211015091413096.png)

只要由符合这两个过滤条件的数据都会进行展会。

#### 计算顺序

WHERE可包含任意数目的AND和OR操作符。允许两者结合以进行复杂和高级的过滤。

~~~mysql
select * from houses where id = 330 or price_num = 3600 and entire = 1;
~~~

> SQL（像多数语言一样）在处理OR操作符前，优先处理AND操作符。

![image-20211015091806416](./img/image-20211015091806416.png)

解决方法：

~~~mysql
select * from houses where (id = 330 or price_num = 3600) and entire = 1;
~~~

![image-20211015091950457](./img/image-20211015091950457.png)

这条SELECT语句与前一条的唯一差别是，这条语句中，前两个条件用圆括号括了起来。因为圆括号具有较AND或OR操作符高的计算次序，DBMS首先过滤圆括号内的OR条件。

> 任何时候使用具有AND和OR操作符的WHERE子句，都应该使用圆括号明确地分组操作符。不要过分依赖默认计算次序，即使它确实是你想要的东西也是如此。使用圆括号没有什么坏处，它能消除歧义。

#### IN 操作符

IN操作符用来指定条件范围，范围中的每个条件都可以进行匹配。IN取合法值的由逗号分隔的清单，全都括在圆括号中。

~~~mysql
SELECT XXX FROM XXX WHERE 列名 操作符 值 IN 列名 (xxx);
~~~

![image-20211015092502993](./img/image-20211015092502993.png)

**优点：**

- 在使用长的合法选项清单时，IN操作符的语法更清楚且更直观。
- 在使用IN时，计算的次序更容易管理（因为使用的操作符更少）
- IN操作符一般比OR操作符清单执行更快。
- IN的最大优点是可以包含其他SELECT语句，使得能够更动态地建立WHERE子句。

**功能与OR相当**


#### NOT 操作符

否定它之后所跟的任何条件。

~~~mysql
SELECT XXX FROM XXX WHERE 列名 操作符 值 NOT IN 列名 (xxx);
~~~

![image-20211015093030997](./img/image-20211015093030997.png)

对于简单的WHERE子句，使用NOT确实没有什么优势。但在更复杂的子句中，NOT是非常有用的。例如，在与IN操作符联合使用时，NOT使找出与条件列表不匹配的行非常简单。

### 通配符过滤

